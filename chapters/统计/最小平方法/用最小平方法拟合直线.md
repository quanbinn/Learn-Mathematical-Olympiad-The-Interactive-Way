# 用最小平方法拟合直线

## 准备好实验工具

- A3标准坐标纸
![](/images/统计/最小平方法/用最小平方法拟合直线/A3标准坐标纸.jpg)
- 无木彩色铅笔（或普通彩色铅笔）
![](/images/统计/最小平方法/用最小平方法拟合直线/无木彩色铅笔.jpg)

## 需要购买的试验工具及商品的地址

- [A3标准坐标纸](https://detail.tmall.com/item.htm?id=27142292922&ali_refid=a3_430583_1006:1105863285:N:dZ%20MV6sJ%20YlXqxaoC1QlJw==:77285e2bbcb0cebf9d00068f21bd840f&ali_trackid=1_77285e2bbcb0cebf9d00068f21bd840f&spm=a230r.1.14.1&skuId=3165771512170)
- [捷克酷喜乐无木彩铅](https://detail.tmall.com/item.htm?spm=a230r.1.14.8.7a1b4237sLkqe4&id=10680260235&cm_id=140105335569ed55e27b&abbucket=9&skuId=3447429972029)

## 获取实验数据

在我们长时间的操作电脑和手机进行学习，工作和娱乐的过程中，大多数人通常都会感觉颈部不适，而且操作电脑和手机的总时间和颈部不适的程度有一种对应关系。下面是这种对应关系的一种计算方法。颈部不适程度采用10分制:10为最大，特别不适，疼痛，难以忍受。1分为最小基本上感觉不到不适和疼痛。


以我的个人感觉为例，得出了下面的4组数据：

- 如果我每天总共用手机和电脑的时间总时间为2小时，那么我颈部不适的指数为1。
- 如果我每天总共用手机和电脑的时间总时间为5小时，那么我颈部不适的指数为4。
- 如果我每天总共用手机和电脑的时间总时间为8小时，那么我颈部不适的指数为5。
- 如果我每天总共用手机和电脑的时间总时间为12小时，那么我颈部不适的指数为6。

即4个数据点（x<sub>i</sub>，y<sub>i</sub>）分别为(2,1),(5,4),(8,5),(12,6)。

## 开始做

### 1. 准备好实验材料，在一张A3的坐标纸上确立一个平面直角坐标系，以坐标纸上最左下角的点为原点，用黑色铅笔画出水平的X轴（以1厘米为1小时）和垂直的Y轴（以1厘米为颈部不适程度的1分），如下图所示。

![](/images/统计/最小平方法/用最小平方法拟合直线/1a.jpg)

### 2. 用蓝色的铅笔把已经取得的4个坐标点：(x<sub>1</sub>=2,y<sub>1</sub>=1),(x<sub>2</sub>=5,y<sub>2</sub>=4),(x<sub>3</sub>=8,y<sub>3</sub>=5),(x<sub>4</sub>=12,y<sub>4</sub>=6)的数据在这个A3的坐标纸做出标记，如下图所示。

![](/images/统计/最小平方法/用最小平方法拟合直线/2a.jpg)

### 3.使用尺子，用绿色的铅笔通过两个点(x<sub>2</sub>=5,y<sub>2</sub>=4)，和(x<sub>3</sub>=8,y<sub>3</sub>=5),画一条直线，这条直线的公式是y=m*x+c（其中m是斜率，c是这条直线与直角坐标系的Y轴相交的点的y-坐标）。

- 通过斜率计算公式：m=△y/△x=(y<sub>3</sub>-y<sub>2</sub>)/(x<sub>3</sub>-x<sub>2</sub>)=(5-4)/(8-5)(代入前面的两个点坐标的值)。
- 通过y-截距的计算公式：c=y-mx=y<sub>2</sub>-mx<sub>2</sub>=4-m*5(代入前面的第一个点坐标的值)。

#### 你的运算结果应该是: 这条直线的斜率是1/3，即0.333；y-截距是4-0.333*5，即2.335；这个直线的方程式：y=0.333x+2.335

![](/images/统计/最小平方法/用最小平方法拟合直线/3a.jpg)

### 4. 用尺子量出这4个点实际的颈部不适程度值（y值）和绿色拟合曲线上相对应的y值的距离，然后估算出相对应的不适值的差。

#### 你的运算过程和结果应该是: 结果大致分别是：-2，0，0，-0.3。它们各自的平方和相加的和是：4 + 0 + 0 + 0.09 = 4.09. 

![](/images/统计/最小平方法/用最小平方法拟合直线/4a.jpg)

### 5. 使用尺子，用红色的铅笔通过两个点(x<sub>2</sub>=5,y<sub>2</sub>=4)，和(x<sub>4</sub>=12,y<sub>4</sub>=6)画一条直线，这条直线的公式是y=m*x+c（其中m是斜率，c是这条直线与直角坐标系的Y轴相交的点的y-坐标）。

- 通过斜率计算公式：m=△y/△x=(y<sub>4</sub>-y<sub>2</sub>)/(x<sub>4</sub>-x<sub>2</sub>)=(6-4)/(12-5)(代入前面的两个点坐标的值)。
- 通过y-截距的计算公式：c=y-mx=y<sub>2</sub>-mx<sub>2</sub>=4-m*5(代入前面的第一个点坐标的值)。

#### 你的运算结果应该是: 这条直线的斜率是2/7，即0.286；y-截距是4-0.286*5，即2.57；这个直线的方程式：y=0.286x+2.57

![](/images/统计/最小平方法/用最小平方法拟合直线/5a.jpg)

### 6. 用尺子量出这4个点实际的颈部不适程度值（y值）和红色拟合曲线上相对应的y值的距离，然后估算出相对应的不适值的差。

#### 你的运算过程和结果应该是: 结果大致分别是：-2.2，0，0.2，0。它们各自的平方和相加的和是：4.84 + 0 + 0.04 + 0 = 4.88. 

![](/images/统计/最小平方法/用最小平方法拟合直线/6a.jpg)

### 7. 使用尺子，用蓝色的铅笔通过两个点(x<sub>1</sub>=2,y<sub>1</sub>=1)，和(x<sub>4</sub>=12,y<sub>4</sub>=6)画一条直线，这条直线的公式是y=m*x+c（其中m是斜率，c是这条直线与直角坐标系的Y轴相交的点的y-坐标）。

- 通过斜率计算公式：m=△y/△x=(y<sub>4</sub>-y<sub>1</sub>)/(x<sub>4</sub>-x<sub>1</sub>)=(6-1)/(12-2)(代入前面的两个点坐标的值)。
- 通过y-截距的计算公式：c=y-mx=y<sub>1</sub>-mx<sub>1</sub>=1-m*2(代入前面的第一个点坐标的值)。

#### 你的运算结果应该是: 这条直线的斜率是5/10，即0.5；y-截距是1-0.5*2，即0；这个直线的方程式：y=0.5x

![](/images/统计/最小平方法/用最小平方法拟合直线/7a.jpg)

### 8. 用尺子量出这4个点实际的颈部不适程度值（y值）和蓝色拟合曲线上相对应的y值的距离，然后估算出相对应的不适值的差。

#### 你的运算过程和结果应该是: 结果大致分别是：0，1.5，1，0。它们各自的平方和相加的和是：0 + 2.25 + 1 + 0 = 3.25. 

![](/images/统计/最小平方法/用最小平方法拟合直线/8a.jpg)

### 9. 因为从肉眼可以看出这4个点不在同一条直线上，所以我们不可能发现一个直线方程式（y=mx+c）能够符合所有4个点的x和y的值。那么问题就转化成我们能否发现一条拟合直线方程（y=mx+c），使这4个点实际的颈部不适程度值（y值）和拟合直线方程上相对应的y值的距离的平方和最小。现在把点坐标用(x<sub>1</sub>,y<sub>1</sub>)(x<sub>2</sub>,y<sub>2</sub>),(x<sub>3</sub>,y<sub>3</sub>),(x<sub>4</sub>,y<sub>4</sub>)代入，分别演算一下这4个距离的平方和分别为多少。

#### 你的演算结果应该如下图所示。

![](/images/统计/最小平方法/用最小平方法拟合直线/9a.jpg)

### 10. 这4个距离的平方和进行相加，然后把(x<sub>1</sub>,y<sub>1</sub>)(x<sub>2</sub>,y<sub>2</sub>),(x<sub>3</sub>,y<sub>3</sub>),(x<sub>4</sub>,y<sub>4</sub>)的具体数值代入，你的演算结果应该如下图所示。

![](/images/统计/最小平方法/用最小平方法拟合直线/10a.jpg)

### 11. 继续演算，你的演算结果应该是：78 - 268m - 32c + 237 m<sup>2</sup> + 54mc + 4c<sup>2</sup>,如下图所示

![](/images/统计/最小平方法/用最小平方法拟合直线/11a.jpg)

### 12.上一次的函数式可写为S(m,c)=237 m<sup>2</sup> + 54mc + 4c<sup>2</sup> - 268m - 32c + 78, 然后这一步求S(m,c)的最小值的问题可简化为求S(m,c)相对于m和c的偏导数为零的问题。你可以演算出两个包含变量m和c的二元一次方程式，如下图所示。 

![](/images/统计/最小平方法/用最小平方法拟合直线/12a.jpg)

### 13.对上一步的两个二元一次方程组求解，你可以运算出: m = 0.475, c = 0.794, 这条最小平方和的直线方程为： y = 0.475x + 0.794，运算过程如下图所示。

![](/images/统计/最小平方法/用最小平方法拟合直线/13a.jpg)

### 14. 把m=0.475和c=0.794带入到第12步的函数中。你可以运算出: S(m,c)的最小值为：1.653，运算过程如下图所示。

![](/images/统计/最小平方法/用最小平方法拟合直线/14a.jpg)

### 15.依据4个点坐标的x值：(x<sub>1</sub>=2),(x<sub>2</sub>=5),(x<sub>3</sub>=8),(x<sub>4</sub>=12)，把他们分别代入到直线方程为： y = 0.475x + 0.794中，可以得出相应的y值：(y<sub>1</sub>=-0.744),(y<sub>2</sub>=0.831),(y<sub>3</sub>=0.406),(y<sub>4</sub>=-0.494), 然后通过这4个点，在坐标纸上用红色的笔画出一条直线。同时通过最小平方和的计算公式，可以计算出这4个点的平方分别为：0.554，0.691，0.027，0.244，他们的和为1.516. 具体的运算过程和画出的直线如下图所示。

![](/images/统计/最小平方法/用最小平方法拟合直线/15a1.jpg)
![](/images/统计/最小平方法/用最小平方法拟合直线/15a2.jpg)

## 参考文献及资料

1. 维基百科
	- [Linear least squares](https://en.wikipedia.org/wiki/Linear_least_squares) | [最小二乘法](https://zh.wikipedia.org/wiki/最小二乘法) 
	- [Partial derivative](https://en.wikipedia.org/wiki/Partial_derivative) | [偏导数](https://zh.wikipedia.org/wiki/偏导数) 